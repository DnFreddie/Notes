<!DOCTYPE html>
<html lang="en-us">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=33371&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>the_world_doesn_t_end_with_scripting | Notes</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="When you start your Linux journey or follow Linux-based YouTubers, you often hear them praising the benefits of writing scripts.
They encourage you to create your own scripts for various tasks because
&ldquo;scripts are simple yet powerful tools to get your work done.&rdquo;
They suggest downloading and using scripts to experience these benefits firsthand, advocating for Bash as the go-to scripting language due to its versatility and ease of use.">
    <meta name="generator" content="Hugo 0.125.4">
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.css" >



    

    
      

    

    

    
      <link rel="canonical" href="http://localhost:33371/posts/posts/the_world_doesn_t_end_with_scripting/">
    

    <meta property="og:url" content="http://localhost:33371/posts/posts/the_world_doesn_t_end_with_scripting/">
  <meta property="og:site_name" content="Notes">
  <meta property="og:title" content="the_world_doesn_t_end_with_scripting">
  <meta property="og:description" content="When you start your Linux journey or follow Linux-based YouTubers, you often hear them praising the benefits of writing scripts.
They encourage you to create your own scripts for various tasks because
“scripts are simple yet powerful tools to get your work done.”
They suggest downloading and using scripts to experience these benefits firsthand, advocating for Bash as the go-to scripting language due to its versatility and ease of use.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-22T09:10:24+02:00">
    <meta property="article:modified_time" content="2024-07-22T09:10:24+02:00">

  <meta itemprop="name" content="the_world_doesn_t_end_with_scripting">
  <meta itemprop="description" content="When you start your Linux journey or follow Linux-based YouTubers, you often hear them praising the benefits of writing scripts.
They encourage you to create your own scripts for various tasks because
&ldquo;scripts are simple yet powerful tools to get your work done.&rdquo;
They suggest downloading and using scripts to experience these benefits firsthand, advocating for Bash as the go-to scripting language due to its versatility and ease of use.">
  <meta itemprop="datePublished" content="2024-07-22T09:10:24+02:00">
  <meta itemprop="dateModified" content="2024-07-22T09:10:24+02:00">
  <meta itemprop="wordCount" content="1178"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="the_world_doesn_t_end_with_scripting">
<meta name="twitter:description" content="When you start your Linux journey or follow Linux-based YouTubers, you often hear them praising the benefits of writing scripts.
They encourage you to create your own scripts for various tasks because
&ldquo;scripts are simple yet powerful tools to get your work done.&rdquo;
They suggest downloading and using scripts to experience these benefits firsthand, advocating for Bash as the go-to scripting language due to its versatility and ease of use.">

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Notes
      
    </a>
    <div class="flex-l items-center">
      

      
      
<div class="ananke-socials">
  
</div>

    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Posts
      </aside>
      










  <div id="sharing" class="mt3 ananke-socials">
    
  </div>


      <h1 class="f1 athelas mt3 mb1">the_world_doesn_t_end_with_scripting</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2024-07-22T09:10:24+02:00">July 22, 2024</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>When you start your Linux journey or follow Linux-based YouTubers, you often hear them praising the benefits of writing scripts.</p>
<p>They encourage you to create your own scripts for various tasks because</p>
<!-- raw HTML omitted -->
<p><strong>&ldquo;scripts are simple yet powerful tools to get your work done.&rdquo;</strong></p>
<!-- raw HTML omitted -->
<p>They suggest downloading and using scripts to experience these benefits firsthand, advocating for Bash as the go-to scripting language due to its versatility and ease of use.</p>
<p>However, what they don&rsquo;t mention is&hellip;</p>
<h2 id="the-misinterpretation">The Misinterpretation</h2>
<p><img src="https://firebasestorage.googleapis.com/v0/b/fbase-2d77d.appspot.com/o/assets%2Fworld_end_scripting%2Fscritpts_header.jpg?alt=media&amp;token=b33f2740-203f-4a06-bca2-9db0e00545d4" alt="Oh Scripts"></p>
<p>The first thing to keep in mind is that shell scripts shouldn&rsquo;t be the primary source of automation.</p>
<p>What I want you to associate scripts with is</p>
<ul>
<li>
<p><strong>quick and dirty</strong> tasks</p>
</li>
<li>
<p><strong>verifying something</strong> fast.</p>
</li>
</ul>
<p>The reason is shell scripting lacks built-in mechanisms for these four things:</p>
<ol>
<li>
<p>Scripts are hard to read due to complex Bash syntax.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Example</span>
</span></span><span style="display:flex;"><span>a<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Hello&#34;</span>
</span></span><span style="display:flex;"><span>b<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;World&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>c<span style="color:#f92672">=</span>$a<span style="color:#e6db74">&#34; &#34;</span>$b
</span></span><span style="display:flex;"><span>d<span style="color:#f92672">=</span>$b<span style="color:#e6db74">&#34; &#34;</span>$a
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>e<span style="color:#f92672">=</span>$c<span style="color:#e6db74">$&#39;\n&#39;</span>$d
</span></span><span style="display:flex;"><span>echo -n <span style="color:#e6db74">&#34;</span>$e<span style="color:#e6db74">&#34;</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>| sed -e <span style="color:#e6db74">&#39;s/o/O/g&#39;</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>| <span style="color:#66d9ef">while</span> IFS<span style="color:#f92672">=</span><span style="color:#e6db74">$&#39;\n&#39;</span> read -r line; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#e6db74">&#34;</span>$line<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span></code></pre></div></li>
<li>
<p>People can easily inject variables into your code, even when using tools like <a href="https://www.shellcheck.net/">ShellCheck</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Vulnerable code</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Enter your name:&#34;</span>
</span></span><span style="display:flex;"><span>read name
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;Hello, </span>$name<span style="color:#e6db74">!&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># All I have to do is type</span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">`</span>John; echo <span style="color:#e6db74">&#34;Haha, I injected a command!&#34;</span><span style="color:#e6db74">`</span>,
</span></span><span style="display:flex;"><span><span style="color:#75715e"># and you know what the output will look like...</span>
</span></span></code></pre></div></li>
<li>
<p>Error handling is minimal, apart from <em>test statements</em> or exit <em>codes</em>.</p>
</li>
<li>
<p>Bash is slow; what works for 100 repetitions doesn&rsquo;t work for a million.</p>
</li>
</ol>
<!-- raw HTML omitted -->
<p>The universal rule is:</p>
<p><strong>If your script is longer than 40 lines, use a programming language.</strong></p>
<!-- raw HTML omitted -->
<h2 id="so-whats-the-alternatvie-then">So what&rsquo;s the alternatvie then?</h2>
<p><img src="https://firebasestorage.googleapis.com/v0/b/fbase-2d77d.appspot.com/o/assets%2Fworld_end_scripting%2Fasniblle_logo.jpg?alt=media&amp;token=e48af70a-e052-42af-8a62-8e0b4141c16e" alt="ansible logo"></p>
<p>Typically, when you start automating tasks like setting up virtual machines and managing dot-files, you want them to be set up quickly, especially when you&rsquo;re unsure which hypervisor tools to use. You can either set up a dot-files repository with scripts that symlink things to proper places or do it manually for every VM.</p>
<p>Some of you may have built scripts around SSH.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh user@hostname <span style="color:#e6db74">&#34;apt install ...&#34;</span>
</span></span></code></pre></div><p><strong>But this isn&rsquo;t maintainable.</strong></p>
<p>As your home lab grows, you&rsquo;ll have more things to configure simultaneously: different machines, package managers, environments, and different types of errors.</p>
<p>Trust me, elaborate scripts won&rsquo;t hold up. You need a better tool. Here comes Ansible, a daemon-less solution&hellip;</p>
<p>So, it&rsquo;s quite simple. Ansible is built around pushing changes using a tool you already love <strong>SSH</strong>.</p>
<p>Ansible connects to the selected machine and pushes changes based on instructions stored in a YAML file, called a playbook.</p>
<p>No matter how many machines you have, Ansible is quick, simple, and nice, without the need to install any daemon on the nodes.</p>
<h2 id="installation">Installation</h2>
<p>Installing Ansible is relatively simple. You have two approaches:</p>
<ol>
<li>Treat Ansible as a project with its own <strong>virtual environment</strong>.</li>
<li>Install it as a <strong>system-wide package</strong>.</li>
</ol>
<p>You might think the second option, global installation, is far superior.</p>
<p>However, Ansible uses Python modules installed on your system.</p>
<p>Imagine needing to install a Python library for virtualization.</p>
<p>You&rsquo;d have to install it system-wide, which could lead to <strong>compatibility issues</strong> later.</p>
<p>Moreover, you&rsquo;re giving administrative privileges to the package.</p>
<p>If the package is malicious or contains vulnerabilities, it can exploit those privileges.</p>
<p><strong>Installation Methods</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt update
</span></span><span style="display:flex;"><span>sudo apt install ansible
</span></span></code></pre></div><p><strong>Or with virtual env:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pip install virtualenv
</span></span><span style="display:flex;"><span>virtualenv ansible-env
</span></span><span style="display:flex;"><span>source ansible-env/bin/activate
</span></span><span style="display:flex;"><span>pip install ansible
</span></span><span style="display:flex;"><span>pip install ansible-core
</span></span></code></pre></div><h3 id="inventory">Inventory</h3>
<p>I&rsquo;m sure you&rsquo;ve already added your lab machines to the SSH config so you can easily SSH into them.</p>
<p>If you haven&rsquo;t, here&rsquo;s how to do it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Create a config file in ~/.ssh and add the following lines for hosts</span>
</span></span><span style="display:flex;"><span>Host ChooseAnyName
</span></span><span style="display:flex;"><span>    HostName ip_address
</span></span><span style="display:flex;"><span>    User username_to_connect_as
</span></span><span style="display:flex;"><span>    IdentityFile ~/.ssh/private key
</span></span></code></pre></div><p>Remember to change the authorization method on your server to PublicKey, so you wouldn&rsquo;t have to <code>--ask-pass</code> every time you want to use Ansible.</p>
<p>Now, having done all of this, you need to create a file called <code>inventory</code> and add the host names to it.
This tells Ansible which device to SSH into and perform tasks.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-toml" data-lang="toml"><span style="display:flex;"><span>[<span style="color:#a6e22e">home</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">dnf</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">my_machine1</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">my_machine2</span>
</span></span></code></pre></div><p><strong>[home]</strong> is the name of the group, so you don&rsquo;t have to call each machine manually one by one.</p>
<h2 id="focus-on-debugging-first">Focus on Debugging First</h2>
<p>We won&rsquo;t write any serious playbooks in this post;
I&rsquo;ll leave that for another time.
But I want you to understand Ansible&rsquo;s modularity and its debugging potential so you can apply quick fixes without writing the whole playbook.</p>
<h2 id="ansible-ad-hoc-and-modularity">Ansible Ad Hoc and Modularity</h2>
<p><img src="https://firebasestorage.googleapis.com/v0/b/fbase-2d77d.appspot.com/o/assets%2Fworld_end_scripting%2Fmodularity.jpg?alt=media&amp;token=8c977b9d-33aa-4c84-bf32-eda093cc8df0" alt="modularity"></p>
<p>Ansible itself is a <strong>suite of tools and modules</strong>.</p>
<p>You have different commands for different tasks.</p>
<p>For example, to get knowledge about a particular module, you use:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ansible-docs -s module_name
</span></span></code></pre></div><p>Modules work similarly to Python modules.</p>
<p>You can call modules alone using the <code>-m</code> flag.</p>
<p>One popular example is the <strong>venv</strong> package, which creates a virtual environment for Python:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>python -m venv /path/to/new/virtual/environment
</span></span></code></pre></div><p>Similarly, in Ansible, you use this pattern:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ansible home -i path_to_inventory -m module_name -a <span style="color:#e6db74">&#39;module arguemnt&#39;</span>
</span></span></code></pre></div><p>There are thousands of modules in Ansible, but I want to focus on two that will be most useful for you:</p>
<ul>
<li><a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/setup_module.html">Setup Module</a></li>
<li><a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/shell_module.html">Shell Module</a></li>
</ul>
<h3 id="setup-quick-and-dirty">Setup Quick and Dirty</h3>
<p><img src="https://firebasestorage.googleapis.com/v0/b/fbase-2d77d.appspot.com/o/assets%2Fworld_end_scripting%2FsetupAns.jpg?alt=media&amp;token=4d2e906f-1dbf-43c9-8235-9b998fcf2992" alt="Ansible setup graphic "></p>
<p>There are many situations where you&rsquo;d like to quickly gather information about your infrastructure.</p>
<p>Are all your machines working? What&rsquo;s their uptime? Do they have the right kernel version?</p>
<p>Here are the all possible  <a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/setup_module.html#parameters">options</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ansible test -i inventory -m setup -a <span style="color:#e6db74">&#39;filter=user_id&#39;</span>
</span></span><span style="display:flex;"><span>ansible test -i inventory -m setup -a <span style="color:#e6db74">&#39;filter=kernel&#39;</span>
</span></span><span style="display:flex;"><span>ansible test -i inventory -m setup -a <span style="color:#e6db74">&#39;filter=ansible_distribution&#39;</span>
</span></span></code></pre></div><h3 id="ansible-can-be-sneaky">Ansible Can Be Sneaky</h3>
<p>You might think Ansible processes tasks one by one, but it actually handles them in parallel.</p>
<p>By default, it handles 5 machines, but you can specify more by adding the <code>-f</code> flag:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ansible test -i inventory -m setup -a <span style="color:#e6db74">&#39;filter=user_id&#39;</span> -f <span style="color:#ae81ff">10</span>
</span></span></code></pre></div><p>It also hides what it&rsquo;s really doing, which could make extended debugging challenging.</p>
<p>Therefore, you have to explicitly call it with the verbosity flag.</p>
<p><strong>It has up to 6 &lsquo;v&rsquo;s</strong> !!!, but  a reasonable level to start is <code>-vvv</code>, feel free to go wild:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ansible test -i inventory -m setup -a <span style="color:#e6db74">&#39;filter=user_id&#39;</span> -vvvvvv
</span></span></code></pre></div><h3 id="finally-back-to-bash">Finally, Back to Bash</h3>
<p><img src="https://firebasestorage.googleapis.com/v0/b/fbase-2d77d.appspot.com/o/assets%2Fworld_end_scripting%2Fbash_matrix.jpg?alt=media&amp;token=6b720cd9-8fe6-4bf2-bcc1-53c6f58eebc1" alt="Bash matrix"></p>
<p>This is the most dirty and  basic but very useful.
If you have a custom script you want to run or if there&rsquo;s no Ansible module that suits your needs.</p>
<p>You can <strong>call Bash directly</strong> on the device with the shell module:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ansible test -i inventory -m shell -a <span style="color:#e6db74">&#39;any_command_you_desire&#39;</span>
</span></span></code></pre></div><p>However, there&rsquo;s a catch:</p>
<p><strong>Ansible doesn&rsquo;t control the output.</strong></p>
<p>It executes the command and checks for errors but always produces a changed result, no matter what the command is.</p>
<h3 id="to-sum-up">To Sum Up</h3>
<p>Bash scripts have their time and place but are not the one and only solution, especially for something you may use on multiple devices.</p>
<p>Try something more stable that won&rsquo;t shoot you in the foot but guide you.</p>
<p>Really, Ansible is awesome, and that&rsquo;s just the beginning of its possibilities.</p>
<p>If you want to learn more about Ansible, Linux, or anything else, chekout  <a href="https://killercoda.com/het-tanis/course/Ansible-Labs">killercoda labs</a></p>
<p>They are free, no need for login, and will walk you through everything without setting up the environment.</p>
<p>Also, join their <a href="https://discord.com/invite/bn4TxafhSH">Discord channel</a> because they&rsquo;re doing a fantastic job educating about Linux.</p>
<p>Peace out :) Hope to see you there!</p>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://localhost:33371/" >
    &copy;  Notes 2024 
  </a>
    <div>
<div class="ananke-socials">
  
</div>
</div>
  </div>
</footer>

  </body>
</html>
